function a89_0x4de4(_0x31e92c,_0x462eeb){const _0x39fca3=a89_0x39fc();return a89_0x4de4=function(_0x4de4a2,_0xf54d46){_0x4de4a2=_0x4de4a2-0x1c2;let _0x296393=_0x39fca3[_0x4de4a2];return _0x296393;},a89_0x4de4(_0x31e92c,_0x462eeb);}const a89_0x45ee07=a89_0x4de4;function a89_0x39fc(){const _0x13953e=['eCusk','authToken','buildName','2058136vVSnbs','MqpGL','BROWSERSTACK_TESTHUB_JWT','../test-observability/requestQueueHandler.js','settings','mFkTv','MZpIX','usLgs','qbwrv','getCiInfo','BROWSERSTACK_CENTRAL_SCANNER_JWT','response','api/v1/builds/','getAccessKey','../performance/performance-tester.js','361476RaJIFW','\x20framework','994739gqXNhT','setupPercy','NGctU','BROWSERSTACK_TEST_OBSERVABILITY','debug','STOP','setAccessibilityVariables','isUndefined','BLcaE','sXmHk','central_scanner','20qhUUQn','Percy\x20is\x20not\x20supported\x20for\x20','../test-observability/sessionHandler.js','9627480LDDBuf','Testhub\x20started\x20with\x20id:\x20','winstonLogger','error','BROWSERSTACK_PRODUCT_MAP','null','user_killed','FTJNb','PERCY_SUPPORTED_FRAMEWORKS','NhXGj','PUT','framework','JfWhp','Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','ENV_VAR','stopBuildUpstream\x20event\x20successful!','getUserName','700712AROSLp','5578243aENaAN','POST','getGitMetaData','../helper','measureWrapper','START','statusText','BROWSERSTACK_CENTRAL_USER','2GeqOVc','config','BROWSERSTACK_CENTRAL_SCANNER_JOBID','atmBL','setTestHubCommonMetaInfo','bDwra','assign','LIUWx','buildStopSent','checkAndSetupPercy','OBSERVABILITY','uploadPending','false','zJOZa','BROWSERSTACK_TESTHUB_UUID','105OxfEtv','BROWSERSTACK_BUILD_RUN_IDENTIFIER','jwt','uMsaH','setTestObservabilityVariables','toISOString','status','job_id','ACCESSIBILITY','BROWSERSTACK_RERUN','getConfig','cYWSl','env','finished_metadata','projectName','auth','wqGWc','message','extractDataFromResponse','Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','BS_TESTOPS_BUILD_COMPLETED','RcMlY','../performance/constants','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20','UCKjj','data','./utils.js','../../bin/utils/constants.js','exports','isAccessibilityEnabled','buildIdentifier','percy','buildHashedId','stringify','BROWSERSTACK_ACCESSIBILITY','launchBuild','16742745AkEGFF','success','5eOLgSG','getAccessibilityOptions','getProductMap','accessibilityOptions','wszzx','bfeWL','resolve','TESTHUB_BUILD_API','generateBuildUpstreamData','waitForBuildStatus','../test-observability/utils','getFrameworkDetails','EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token'];a89_0x39fc=function(){return _0x13953e;};return a89_0x39fc();}(function(_0x230ae0,_0x4deaab){const _0x3bd377=a89_0x4de4,_0x2c32a7=_0x230ae0();while(!![]){try{const _0x202baf=-parseInt(_0x3bd377(0x1fd))/0x1*(parseInt(_0x3bd377(0x225))/0x2)+-parseInt(_0x3bd377(0x1fb))/0x3+-parseInt(_0x3bd377(0x1ec))/0x4*(parseInt(_0x3bd377(0x1dc))/0x5)+-parseInt(_0x3bd377(0x20b))/0x6+parseInt(_0x3bd377(0x234))/0x7*(parseInt(_0x3bd377(0x21c))/0x8)+parseInt(_0x3bd377(0x1da))/0x9+parseInt(_0x3bd377(0x208))/0xa*(parseInt(_0x3bd377(0x21d))/0xb);if(_0x202baf===_0x4deaab)break;else _0x2c32a7['push'](_0x2c32a7['shift']());}catch(_0x2baa1d){_0x2c32a7['push'](_0x2c32a7['shift']());}}}(a89_0x39fc,0xe8ea5));const bsSetupHelper=require(a89_0x45ee07(0x220)),path=require('path'),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require(a89_0x45ee07(0x1e6)),testhubUtils=require(a89_0x45ee07(0x1d0)),testHubConstants=require('./constants.js'),constants=require(a89_0x45ee07(0x1d1)),RequestQueueHandler=require(a89_0x45ee07(0x1ef)),logger=require('../logger')[a89_0x45ee07(0x20d)],SessionHandler=require(a89_0x45ee07(0x20a)),PerformanceTester=require(a89_0x45ee07(0x1fa)),{TESTHUB_EVENTS:PerformanceEvents}=require(a89_0x45ee07(0x1cc));class TestHubHandler{static [a89_0x45ee07(0x22d)]=![];static async[a89_0x45ee07(0x1d9)](_0x74e95f,_0x25e4a5){const _0x14de65=a89_0x45ee07,_0x106cc1={'UCKjj':function(_0xe17d8b,_0x7a0da6){return _0xe17d8b||_0x7a0da6;},'NhXGj':function(_0x441794,_0x1847e2){return _0x441794||_0x1847e2;},'sIvip':function(_0x2e0b4f,_0x566250){return _0x2e0b4f===_0x566250;},'wszzx':function(_0x4c74ff){return _0x4c74ff();},'GBbtY':_0x14de65(0x1e8),'zJOZa':_0x14de65(0x231),'mFkTv':_0x14de65(0x218),'LIUWx':function(_0x3c960f,_0x270f21,_0x3f52c9,_0xcc2cbf,_0x410b72){return _0x3c960f(_0x270f21,_0x3f52c9,_0xcc2cbf,_0x410b72);},'vdsao':_0x14de65(0x21e),'sXmHk':function(_0x12e316,_0x1a5eaa){return _0x12e316===_0x1a5eaa;}};await PerformanceTester[_0x14de65(0x221)](PerformanceEvents[_0x14de65(0x222)],async()=>{const _0x1f4ce2=_0x14de65,_0x1fd766=Object[_0x1f4ce2(0x22b)]({},_0x25e4a5['config'],{'root_dir_path':'','framework':_0x25e4a5[_0x1f4ce2(0x216)]}),_0x4989e3=bsSetupHelper[_0x1f4ce2(0x21b)](_0x1fd766),_0x47d9cd=bsSetupHelper[_0x1f4ce2(0x1f9)](_0x1fd766),_0x496e37=_0x106cc1[_0x1f4ce2(0x1ce)](_0x4989e3,'')+':'+_0x106cc1[_0x1f4ce2(0x214)](_0x47d9cd,''),_0x523f63=testhubUtils[_0x1f4ce2(0x1de)](_0x1fd766);process[_0x1f4ce2(0x1c2)][_0x1f4ce2(0x20f)]=JSON[_0x1f4ce2(0x1d7)](_0x523f63);if(_0x106cc1['sIvip'](_0x496e37,':'))return _0x106cc1[_0x1f4ce2(0x1e0)](isTestObservabilitySession)&&(logger[_0x1f4ce2(0x201)](_0x106cc1['GBbtY']),process[_0x1f4ce2(0x1c2)]['BS_TESTOPS_BUILD_COMPLETED']=_0x106cc1[_0x1f4ce2(0x232)]),testhubUtils[_0x1f4ce2(0x1d3)](_0x1fd766)&&logger['debug'](_0x106cc1[_0x1f4ce2(0x1f1)]),[null,null];try{const _0x227fd1=await this[_0x1f4ce2(0x1e4)](_0x1fd766,_0x74e95f),_0x42d94a=this[_0x1f4ce2(0x23e)](_0x4989e3,_0x47d9cd),_0x4e31a5=await _0x106cc1[_0x1f4ce2(0x22c)](nodeRequest,_0x106cc1['vdsao'],testHubConstants[_0x1f4ce2(0x1e3)],_0x227fd1,_0x42d94a);await this[_0x1f4ce2(0x22e)](_0x25e4a5,_0x74e95f);const _0x41e193=this['extractDataFromResponse'](_0x1fd766,_0x4e31a5,_0x42d94a);return _0x41e193;}catch(_0x1aa166){if(_0x106cc1[_0x1f4ce2(0x206)](_0x1aa166[_0x1f4ce2(0x1db)],![])){testhubUtils['logBuildError'](_0x1aa166);return;}}})();}static async['checkAndSetupPercy'](_0x475ee1,_0x5eb0f0){const _0x2375f8=a89_0x45ee07;if(constants[_0x2375f8(0x213)]['includes'](_0x5eb0f0)){await _0x475ee1[_0x2375f8(0x1fe)]();return;}_0x475ee1[_0x2375f8(0x226)][_0x2375f8(0x1d5)]&&logger[_0x2375f8(0x201)](_0x2375f8(0x209)+_0x5eb0f0+_0x2375f8(0x1fc));}static[a89_0x45ee07(0x1dd)](_0x23ca0f){const _0x1366ef=a89_0x45ee07,_0x3f9fba={};_0x3f9fba[_0x1366ef(0x1f0)]=_0x23ca0f[_0x1366ef(0x1df)];const _0x4c7ad6=_0x3f9fba;return _0x4c7ad6;}static[a89_0x45ee07(0x23e)](_0x4e0564,_0x2a96f7){const _0x320278=a89_0x45ee07,_0x5b49ae={'wqGWc':function(_0x4cea9d,_0x196e8a){return _0x4cea9d(_0x196e8a);}},_0x509bf5={};return _0x509bf5['username']=_0x4e0564,_0x509bf5['password']=_0x2a96f7,{'auth':_0x509bf5,'headers':_0x5b49ae[_0x320278(0x1c6)](getDefaultHeaders,![])};}static async['generateBuildUpstreamData'](_0x16c758,_0x4de4a6){const _0x46443c=a89_0x45ee07,_0x41d367={'vAbxm':function(_0x86c571,_0x36304a){return _0x86c571(_0x36304a);}},_0x5d9f06={'project_name':_0x16c758[_0x46443c(0x1c4)]||'','name':_0x16c758[_0x46443c(0x1eb)]||path['basename'](path[_0x46443c(0x1e2)](process['cwd']())),'build_identifier':_0x16c758[_0x46443c(0x1d4)],'description':_0x16c758['buildDescription']||'','started_at':new Date()[_0x46443c(0x239)](),'tags':_0x41d367['vAbxm'](getCustomTags,_0x16c758),'host_info':bsSetupHelper['getHostInfo'](),'ci_info':bsSetupHelper[_0x46443c(0x1f5)](),'build_run_identifier':process['env'][_0x46443c(0x235)],'failed_tests_rerun':process[_0x46443c(0x1c2)][_0x46443c(0x23d)]||![],'version_control':await bsSetupHelper[_0x46443c(0x21f)](),'accessibility':this[_0x46443c(0x1dd)](_0x16c758),'framework_details':testhubUtils[_0x46443c(0x1e7)](_0x16c758,_0x4de4a6),'product_map':testhubUtils[_0x46443c(0x1de)](_0x16c758),'browserstackAutomation':bsSetupHelper['isBrowserstackInfra']()};if(process[_0x46443c(0x1c2)][_0x46443c(0x224)]){const _0x439854={};_0x439854[_0x46443c(0x23b)]=process[_0x46443c(0x1c2)][_0x46443c(0x227)],_0x439854['token']=process['env'][_0x46443c(0x1f6)],_0x5d9f06[_0x46443c(0x207)]=_0x439854;}return _0x5d9f06;}static[a89_0x45ee07(0x1c8)](_0x3f13d2,_0x43448e,_0x133b48){const _0x384117=a89_0x45ee07,_0x3789f0={'BLcaE':function(_0x45929e){return _0x45929e();},'bDwra':function(_0x119410,_0x3b3fbe){return _0x119410&&_0x3b3fbe;},'qbwrv':'true','atmBL':_0x384117(0x231),'RcMlY':function(_0x9eeca7,_0x22d093){return _0x9eeca7&&_0x22d093;}},_0x18cbcf={};if(_0x3789f0[_0x384117(0x205)](isTestObservabilitySession)){const [_0x5da6a4,_0x53ad8d,_0x345333]=testhubUtils[_0x384117(0x238)](_0x43448e[_0x384117(0x1cf)],_0x133b48[_0x384117(0x1c5)]);if(_0x3789f0[_0x384117(0x22a)](_0x5da6a4,_0x53ad8d)){const _0xf45cd1={};_0xf45cd1[_0x384117(0x236)]=_0x5da6a4,_0xf45cd1['buildHashedId']=_0x53ad8d,_0xf45cd1['allowScreenshot']=_0x345333,_0x18cbcf[testHubConstants['OBSERVABILITY']]=_0xf45cd1,process[_0x384117(0x1c2)][_0x384117(0x200)]=_0x3789f0[_0x384117(0x1f4)];}else _0x18cbcf[testHubConstants[_0x384117(0x22f)]]={},process[_0x384117(0x1c2)]['BROWSERSTACK_TEST_OBSERVABILITY']=_0x3789f0['atmBL'];}else process[_0x384117(0x1c2)][_0x384117(0x200)]=_0x3789f0['atmBL'];if(testhubUtils[_0x384117(0x1d3)](_0x3f13d2)){const [_0x196238,_0x295806]=testhubUtils[_0x384117(0x203)](_0x43448e['data']);if(_0x3789f0[_0x384117(0x1cb)](_0x196238,_0x295806)){const _0x29393f={};_0x29393f[_0x384117(0x1ea)]=_0x196238,_0x29393f[_0x384117(0x1d6)]=_0x295806,_0x18cbcf[testHubConstants['ACCESSIBILITY']]=_0x29393f,process[_0x384117(0x1c2)][_0x384117(0x1d8)]=_0x3789f0[_0x384117(0x1f4)];}else _0x18cbcf[testHubConstants[_0x384117(0x23c)]]={},process['env'][_0x384117(0x1d8)]=_0x3789f0['atmBL'];}else process['env']['BROWSERSTACK_ACCESSIBILITY']=_0x3789f0[_0x384117(0x228)];return testhubUtils[_0x384117(0x229)](_0x43448e[_0x384117(0x1cf)]),logger['info'](_0x384117(0x20c)+process[_0x384117(0x1c2)][_0x384117(0x233)]),_0x18cbcf;}static async['stop'](_0x4324a1){const _0xec3693=a89_0x45ee07,_0x4c9470={'cYWSl':function(_0x1a47b6,_0xce0da1){return _0x1a47b6===_0xce0da1;},'itoGu':_0xec3693(0x231),'FTJNb':_0xec3693(0x210),'uMsaH':function(_0xd163d6,_0x552c98){return _0xd163d6===_0x552c98;},'epVZA':'EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','eCusk':_0xec3693(0x20e),'usLgs':_0xec3693(0x1c9),'MZpIX':_0xec3693(0x1c3),'DrpvU':_0xec3693(0x211),'hwUja':function(_0x4f97e3){return _0x4f97e3();},'bfeWL':function(_0xa97930,_0x2bd4cb,_0x51c9fb,_0x3cfb8e,_0x17be13,_0x40b2a0){return _0xa97930(_0x2bd4cb,_0x51c9fb,_0x3cfb8e,_0x17be13,_0x40b2a0);},'MqpGL':_0xec3693(0x215),'NGctU':_0xec3693(0x21a),'JfWhp':_0xec3693(0x1db)};await PerformanceTester[_0xec3693(0x221)](PerformanceEvents[_0xec3693(0x202)],async()=>{const _0x1e4c9d=_0xec3693;if(_0x4c9470[_0x1e4c9d(0x23f)](process[_0x1e4c9d(0x1c2)][_0x1e4c9d(0x1ca)],_0x4c9470['itoGu'])||TestHubHandler[_0x1e4c9d(0x22d)]||bsSetupHelper[_0x1e4c9d(0x204)](process[_0x1e4c9d(0x1c2)][testHubConstants[_0x1e4c9d(0x219)][_0x1e4c9d(0x1ee)]]))return;TestHubHandler['buildStopSent']=!![],await RequestQueueHandler['getInstance']()[_0x1e4c9d(0x230)](),await SessionHandler[_0x1e4c9d(0x1e5)]();if(_0x4c9470[_0x1e4c9d(0x23f)](process['env'][testHubConstants[_0x1e4c9d(0x219)][_0x1e4c9d(0x1ee)]],_0x4c9470[_0x1e4c9d(0x212)])||_0x4c9470[_0x1e4c9d(0x237)](process['env'][testHubConstants[_0x1e4c9d(0x219)][_0x1e4c9d(0x233)]],_0x4c9470['FTJNb'])){logger[_0x1e4c9d(0x201)](_0x4c9470['epVZA']);const _0x29da66={};return _0x29da66['status']=_0x4c9470[_0x1e4c9d(0x1e9)],_0x29da66[_0x1e4c9d(0x1c7)]=_0x4c9470[_0x1e4c9d(0x1f3)],_0x29da66;}const _0x3daa15={'finished_at':new Date()[_0x1e4c9d(0x239)](),'finished_metadata':[]};!!_0x4324a1&&_0x3daa15[_0x4c9470[_0x1e4c9d(0x1f2)]]['push']({'reason':_0x4c9470['DrpvU'],'signal':_0x4324a1,'failure_data':''});const _0x3097c9={'headers':_0x4c9470['hwUja'](getDefaultHeaders)};try{const _0x50668b=await _0x4c9470[_0x1e4c9d(0x1e1)](nodeRequest,_0x4c9470[_0x1e4c9d(0x1ed)],_0x1e4c9d(0x1f8)+process[_0x1e4c9d(0x1c2)][testHubConstants['ENV_VAR'][_0x1e4c9d(0x233)]]+'/stop',_0x3daa15,_0x3097c9,![]);if(_0x50668b[_0x1e4c9d(0x1cf)]&&_0x50668b[_0x1e4c9d(0x1cf)][_0x1e4c9d(0x20e)]){const _0x4e7e25={};_0x4e7e25['message']=_0x50668b[_0x1e4c9d(0x1cf)][_0x1e4c9d(0x20e)];throw _0x4e7e25;}else{logger[_0x1e4c9d(0x201)](_0x4c9470[_0x1e4c9d(0x1ff)]);const _0x18b23b={};return _0x18b23b['status']=_0x4c9470[_0x1e4c9d(0x217)],_0x18b23b[_0x1e4c9d(0x1c7)]='',_0x18b23b;}}catch(_0x5bff85){_0x5bff85[_0x1e4c9d(0x1f7)]?logger['debug']('EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20'+_0x5bff85['response'][_0x1e4c9d(0x23a)]+'\x20'+_0x5bff85[_0x1e4c9d(0x1f7)][_0x1e4c9d(0x223)]+'\x20'+JSON[_0x1e4c9d(0x1d7)](_0x5bff85[_0x1e4c9d(0x1f7)][_0x1e4c9d(0x1cf)])):logger['debug'](_0x1e4c9d(0x1cd)+(_0x5bff85[_0x1e4c9d(0x1c7)]||_0x5bff85));const _0x3b45c7={};return _0x3b45c7[_0x1e4c9d(0x23a)]=_0x4c9470['eCusk'],_0x3b45c7[_0x1e4c9d(0x1c7)]=_0x5bff85[_0x1e4c9d(0x1c7)]||_0x5bff85['response']?_0x5bff85[_0x1e4c9d(0x1f7)][_0x1e4c9d(0x23a)]+':'+_0x5bff85['response'][_0x1e4c9d(0x223)]:_0x5bff85,_0x3b45c7;}})();}}module[a89_0x45ee07(0x1d2)]=TestHubHandler;