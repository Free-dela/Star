const a19_0x4f3e0a=a19_0x6f7a;(function(_0x4e27e9,_0x26c506){const _0x4e0136=a19_0x6f7a,_0x1cea48=_0x4e27e9();while(!![]){try{const _0x54eb97=-parseInt(_0x4e0136(0x1f9))/0x1*(-parseInt(_0x4e0136(0x224))/0x2)+parseInt(_0x4e0136(0x20e))/0x3*(parseInt(_0x4e0136(0x212))/0x4)+parseInt(_0x4e0136(0x244))/0x5*(parseInt(_0x4e0136(0x200))/0x6)+-parseInt(_0x4e0136(0x216))/0x7*(-parseInt(_0x4e0136(0x21b))/0x8)+parseInt(_0x4e0136(0x22c))/0x9*(parseInt(_0x4e0136(0x1ff))/0xa)+-parseInt(_0x4e0136(0x209))/0xb+-parseInt(_0x4e0136(0x20b))/0xc*(parseInt(_0x4e0136(0x233))/0xd);if(_0x54eb97===_0x26c506)break;else _0x1cea48['push'](_0x1cea48['shift']());}catch(_0x1be920){_0x1cea48['push'](_0x1cea48['shift']());}}}(a19_0x4c9e,0x95937));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a19_0x4f3e0a(0x1ea)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require('../../config/constants'),{logger}=require(a19_0x4f3e0a(0x22b)),{getCredentialsPath,getGridDetails}=require(a19_0x4f3e0a(0x23e)),{scaleDownHubDeployment}=require(a19_0x4f3e0a(0x1ed)),{sendInstrumentationEvent}=require(a19_0x4f3e0a(0x217)),webSocketUtils=require(a19_0x4f3e0a(0x230)),{createK8sClient}=require('../../utils/createk8sClient'),{getCloudProviderObject}=require(a19_0x4f3e0a(0x1e8));function a19_0x4c9e(){const _0x121ddb=['ABgbo','unauthorised','nkcuU','Wdgak','type','connectionTimeout','description','debug','9092666DGsWzm','BfkxF','32592yCsXpE','exit','UmKMU','1611RiiNyi','command','statusCode','AXCmI','8956yMZCQk','bDnDj','WlxOe','help','13867sSoUAe','../../utils/instrumentationUtils','ERROR','WebSocket','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','3056pAvTGn','clusterName','gridId','bstackUsername','qWfuW','INFO','replace','skipTlsCertVerify','name','4SLGwyA','invalid-grid-id','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','stringify','handler','Adding\x20Websocket\x20listeners','Grid\x20stoppped.','../../config/logger','9469854OMrwdd','UgJkz','mNkak','UTDny','../../utils/webSocketUtils','stop','user','12610RCtwGi','skip-tls-cert-verify','YSXdh','server-error','Skip\x20insecure\x20cert\x20verification.','grid','NsUyH','info','Stopping\x20grid\x20','<PasswordPlaceholder>','<UsernamePlaceholder>','../../utils/utilityMethods','existsSync','kehHm','default','Browserstack','TcPan','190MEfIrs','body','stop-grid-called','cloudProvider','bstackAccesskey','xVNTM','boolean','epilogue','region','XEaPH','parse','cqXfL','../../cloudproviders/utils','init-not-called','reconnecting-websocket','username','CeaOi','../../utils/gridComponents','hwrft','desc','password','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','Stop\x20a\x20running\x20Automation\x20grid.','error','PdZlz','usage','addListeners','argv','builder','472159fHmluU','fHIKh','grid-id','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','options','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','10jmqsSG','18660IDTnvv'];a19_0x4c9e=function(){return _0x121ddb;};return a19_0x4c9e();}function a19_0x6f7a(_0x350067,_0x43b0d8){const _0x4c9e0b=a19_0x4c9e();return a19_0x6f7a=function(_0x6f7a31,_0x4ebc7d){_0x6f7a31=_0x6f7a31-0x1e4;let _0x228cc5=_0x4c9e0b[_0x6f7a31];return _0x228cc5;},a19_0x6f7a(_0x350067,_0x43b0d8);}exports[a19_0x4f3e0a(0x20f)]=a19_0x4f3e0a(0x238),exports[a19_0x4f3e0a(0x1ef)]=a19_0x4f3e0a(0x1f2),exports[a19_0x4f3e0a(0x1f8)]=function(_0x1921fc){const _0x5191b9=a19_0x4f3e0a,_0x20ac15={};_0x20ac15[_0x5191b9(0x1fa)]=_0x5191b9(0x1fe),_0x20ac15[_0x5191b9(0x249)]='string',_0x20ac15['ABgbo']=_0x5191b9(0x237),_0x20ac15[_0x5191b9(0x211)]=_0x5191b9(0x24a),_0x20ac15[_0x5191b9(0x213)]=_0x5191b9(0x215);const _0x5241cc=_0x20ac15,_0xe15262={};_0xe15262['description']=_0x5241cc['fHIKh'],_0xe15262[_0x5191b9(0x205)]=_0x5241cc[_0x5191b9(0x249)];const _0x2f27b5={};_0x2f27b5[_0x5191b9(0x207)]=_0x5241cc[_0x5191b9(0x201)],_0x2f27b5['type']=_0x5241cc[_0x5191b9(0x211)],_0x2f27b5[_0x5191b9(0x241)]=![];const _0x4453db={};return _0x4453db[_0x5191b9(0x1fb)]=_0xe15262,_0x4453db[_0x5191b9(0x234)]=_0x2f27b5,_0x1921fc[_0x5191b9(0x1f5)](HELP_HEADER_MESSAGE[_0x5191b9(0x231)])[_0x5191b9(0x24b)](HELP_FOOTER_MESSAGE)[_0x5191b9(0x1fd)](_0x4453db)[_0x5191b9(0x215)](_0x5241cc[_0x5191b9(0x213)])[_0x5191b9(0x1f7)];},exports[a19_0x4f3e0a(0x228)]=async function(_0x30b2ee){const _0x1d043d=a19_0x4f3e0a,_0x6941c5={'UmKMU':_0x1d043d(0x1fc),'hwrft':function(_0x13f41b){return _0x13f41b();},'NsUyH':_0x1d043d(0x1f1),'YSXdh':function(_0x2c94c2,_0x559277,_0xee0557,_0x286007,_0x2aa0ea,_0x10b535,_0x1cc7a0){return _0x2c94c2(_0x559277,_0xee0557,_0x286007,_0x2aa0ea,_0x10b535,_0x1cc7a0);},'UgJkz':_0x1d043d(0x246),'pQOtc':_0x1d043d(0x1e9),'BfkxF':_0x1d043d(0x23d),'WlxOe':_0x1d043d(0x23c),'TcPan':_0x1d043d(0x229),'XEaPH':function(_0x10cdfc,_0x2526bc,_0x38bb9d,_0x350e64){return _0x10cdfc(_0x2526bc,_0x38bb9d,_0x350e64);},'qWfuW':function(_0x5c84ba,_0x33bc29,_0x4fa779,_0x4fcd33,_0x516b28,_0x37cc10,_0x4062ed){return _0x5c84ba(_0x33bc29,_0x4fa779,_0x4fcd33,_0x516b28,_0x37cc10,_0x4062ed);},'kehHm':function(_0x46f8d6,_0x4f6ca1,_0x18f911){return _0x46f8d6(_0x4f6ca1,_0x18f911);},'bYYXB':_0x1d043d(0x22a),'CeaOi':function(_0x375081,_0x1b3db0){return _0x375081===_0x1b3db0;},'UTDny':_0x1d043d(0x21a),'cqXfL':function(_0x174ee7,_0x5e082e,_0x233fe,_0xd79757,_0x157c17,_0x5894a7,_0x16b9e6){return _0x174ee7(_0x5e082e,_0x233fe,_0xd79757,_0x157c17,_0x5894a7,_0x16b9e6);},'kddqs':_0x1d043d(0x202),'Wdgak':function(_0x1a7406,_0x15c07d){return _0x1a7406===_0x15c07d;},'nkcuU':function(_0x139811,_0x5b1f95,_0x4e941c,_0x377ae0,_0x16d02b,_0x56c702,_0x479f96){return _0x139811(_0x5b1f95,_0x4e941c,_0x377ae0,_0x16d02b,_0x56c702,_0x479f96);},'mNkak':_0x1d043d(0x225),'PdZlz':_0x1d043d(0x236)};let _0x52ea36;try{!_0x30b2ee['gridId']&&(logger['error'](_0x6941c5[_0x1d043d(0x20d)]),process[_0x1d043d(0x20c)](0x1));!fs[_0x1d043d(0x23f)](_0x6941c5[_0x1d043d(0x1ee)](getCredentialsPath))&&(logger['error'](_0x6941c5[_0x1d043d(0x239)]),await _0x6941c5[_0x1d043d(0x235)](sendInstrumentationEvent,_0x30b2ee,_0x6941c5[_0x1d043d(0x22d)],messageTypes[_0x1d043d(0x218)],_0x6941c5['pQOtc'],null,_0x30b2ee),process[_0x1d043d(0x20c)](0x1));logger[_0x1d043d(0x23a)](_0x1d043d(0x23b)+_0x30b2ee[_0x1d043d(0x21d)]),await _0x6941c5[_0x1d043d(0x235)](sendInstrumentationEvent,_0x30b2ee,_0x6941c5[_0x1d043d(0x22d)],messageTypes[_0x1d043d(0x220)],null,null,_0x30b2ee);const _0xb7adc0=JSON[_0x1d043d(0x1e6)](fs['readFileSync'](_0x6941c5[_0x1d043d(0x1ee)](getCredentialsPath)));global_registry[_0x1d043d(0x21e)]=_0xb7adc0['Browserstack'][_0x1d043d(0x1eb)],global_registry[_0x1d043d(0x248)]=_0xb7adc0[_0x1d043d(0x242)][_0x1d043d(0x1f0)];const _0x53e036=WS_ENDPOINT[_0x1d043d(0x221)](_0x6941c5[_0x1d043d(0x20a)],_0xb7adc0[_0x1d043d(0x242)][_0x1d043d(0x1eb)])[_0x1d043d(0x221)](_0x6941c5[_0x1d043d(0x214)],_0xb7adc0[_0x1d043d(0x242)][_0x1d043d(0x1f0)]),_0x309d5e={};_0x309d5e[_0x1d043d(0x219)]=ws,_0x309d5e[_0x1d043d(0x206)]=0x36ee80,_0x52ea36=new ReconnectingWebSocket(_0x53e036,[],_0x309d5e),logger[_0x1d043d(0x208)](_0x6941c5[_0x1d043d(0x243)]),webSocketUtils[_0x1d043d(0x1f6)](_0x52ea36,_0x30b2ee[_0x1d043d(0x232)],_0x30b2ee[_0x1d043d(0x1f0)]);const [_0x5c5e98,_0x9cdf95]=await _0x6941c5[_0x1d043d(0x1e5)](getGridDetails,_0xb7adc0[_0x1d043d(0x242)][_0x1d043d(0x1eb)],_0xb7adc0['Browserstack'][_0x1d043d(0x1f0)],_0x30b2ee['gridId']);if(_0x9cdf95){const _0x57a9be=_0x9cdf95[_0x1d043d(0x23a)];global_registry[_0x1d043d(0x247)]=_0x57a9be[_0x1d043d(0x247)],global_registry['clusterRegion']=_0x57a9be[_0x1d043d(0x1e4)],global_registry[_0x1d043d(0x21c)]=_0x57a9be['clusterName'];const _0x568456=await _0x6941c5[_0x1d043d(0x21f)](getCloudProviderObject,_0x57a9be[_0x1d043d(0x247)],_0x57a9be[_0x1d043d(0x21c)],_0x57a9be[_0x1d043d(0x223)],_0x52ea36,webSocketUtils,_0x30b2ee),[_0xefdef4,_0x26ce8c,_0x2a8639,_0x242084,_0x76b572,_0x2db92f]=await _0x6941c5[_0x1d043d(0x240)](createK8sClient,_0x568456,_0x30b2ee[_0x1d043d(0x222)]);await _0x6941c5[_0x1d043d(0x240)](scaleDownHubDeployment,_0x26ce8c,_0x57a9be['name']),logger[_0x1d043d(0x23a)](_0x6941c5['bYYXB']),process[_0x1d043d(0x20c)](0x0);}_0x6941c5[_0x1d043d(0x1ec)](_0x5c5e98[_0x1d043d(0x210)],0x191)&&(logger[_0x1d043d(0x1f3)](_0x6941c5[_0x1d043d(0x22f)]),await _0x6941c5[_0x1d043d(0x1e7)](sendInstrumentationEvent,_0x30b2ee,_0x6941c5['UgJkz'],messageTypes[_0x1d043d(0x218)],_0x6941c5['kddqs'],null,_0x30b2ee),process[_0x1d043d(0x20c)](0x1)),_0x6941c5[_0x1d043d(0x204)](_0x5c5e98[_0x1d043d(0x210)],0x190)&&(logger[_0x1d043d(0x1f3)](JSON[_0x1d043d(0x1e6)](_0x5c5e98[_0x1d043d(0x245)])['message']),await _0x6941c5[_0x1d043d(0x203)](sendInstrumentationEvent,_0x30b2ee,_0x6941c5[_0x1d043d(0x22d)],messageTypes[_0x1d043d(0x218)],_0x6941c5[_0x1d043d(0x22e)],null,_0x30b2ee),process['exit'](0x1)),logger[_0x1d043d(0x1f3)]('Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20'+JSON[_0x1d043d(0x227)](_0x5c5e98)),await _0x6941c5[_0x1d043d(0x235)](sendInstrumentationEvent,_0x30b2ee,_0x6941c5[_0x1d043d(0x22d)],messageTypes['ERROR'],_0x6941c5[_0x1d043d(0x1f4)],_0x5c5e98,_0x30b2ee),process['exit'](0x1);}catch(_0x4dd046){const _0x3a340b=_0x1d043d(0x226)+_0x4dd046+'\x20\x0a'+JSON['stringify'](_0x4dd046['stack'])+'\x20';logger[_0x1d043d(0x1f3)](_0x3a340b),process[_0x1d043d(0x20c)](0x1);}};